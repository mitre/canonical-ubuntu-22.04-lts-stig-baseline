---
verifier:
  name: inspec
  sudo: true
  reporter:
    - cli
    - json:spec/results/%{platform}_%{suite}.json
  inspec_tests:
    - name: Ubuntu 22.04 STIG
      path: .
  input_files:
    - inputs.yml
  <% if ENV['INSPEC_CONTROL'] %>
  controls:
    - "<%= ENV['INSPEC_CONTROL'] %>"
  <% end %>
  load_plugins: true
  env_vars:
    - "CHEF_LICENSE=<%= ENV['CHEF_LICENSE'] %>"


platforms:
- name: ubuntu-2204

suites:
  - name: vanilla
    transport:
      port: 2211
      hostname: 127.0.0.1
      ssh_key: ~/.ssh/id_ed25519
    # provisioner:
    #   playbook: spec/ansible/roles/ansible-role-u22-vanilla.yml

  - name: hardened
    transport:
      port: 2200
      hostname: 127.0.0.1
      ssh_key: ~/.ssh/id_ed25519
  #   provisioner:
  #     playbook: spec/ansible/roles/ansible-role-rhel-hardened.yml

transport:
  max_ssh_sessions: 6
  # port: 2200
  